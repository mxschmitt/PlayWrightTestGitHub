on: 
  push:
  workflow_dispatch:

jobs:
   
  test:
    runs-on: windows-latest

    steps:
    
    - uses: actions/checkout@v3

    - name: Cache Playwright Browser
      uses: actions/cache@v3
      with:
        path: ~\AppData\Local\ms-playwright
        key: playwright-browser

    - name: Install playwright
      run: |
        $playwrightInstaller = Get-Childitem -Path .\src\XUnitTestProject\ -Recurse playwright.ps1
        & $playwrightInstaller install

    - name: Setup VSTest Path
      uses: darenm/Setup-VSTest@v1.2

    - uses: mxschmitt/action-tmate@v3

    - name: Run Unit Tests
      run: |
        $testDll = Get-ChildItem -Recurse .\XUnitTestProject.dll
        vstest.console.exe $testDll
